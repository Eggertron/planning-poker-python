<!doctype html>
<title>Hello from Flask</title>
{% if name %}
  <h1>Hello {{ name }}!</h1>
{% else %}
  <h1>Hello, World!</h1>
{% endif %}
<br>
<form method=post>
{% if admin %}
<h2>Hide Votes?</h2>
	<input type=submit name=vote value="True">
	<input type=submit name=vote value="False">
<br>
{% endif %}
	<input type=submit name=vote value="1">
	<input type=submit name=vote value="2">
	<input type=submit name=vote value="3">
	<input type=submit name=vote value="5">
	<input type=submit name=vote value="8">
	<input type=submit name=vote value="13">
</form>
<br>
<h2>Current Message</h2>
<br>
<textarea rows="1" cols="50">
	{{ information }}
</textarea> 
<br>
<br>
<h2>Some Div stuff</h2>
<div id="this-div">
{{ board }}
</div>


<script>
    // Client-side Javascript in the HTML
    var targetContainer = document.getElementById("this-div");
    var eventSource = new EventSource("/stream/{{ room_id }}");

    eventSource.onmessage = function(e) {
	var data_main = JSON.parse(e.data);
	var room_data = data_main["{{ room_id }}"];
	var users_data = room_data.users;
	var results = "";
	for (var name in users_data) {
	    var user_data = users_data[name];
	    var vote = user_data["vote"];
	    if (vote == "-1") {
                vote = "?";
            }
	    results += "" + name + " votes " + vote + "<br>";
        } 
	targetContainer.innerHTML = results;
    };
</script>
